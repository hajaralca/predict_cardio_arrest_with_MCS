 # Core Monte Carlo simulation logic